
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="This is Michael Qiu's personal site." name="description"/>
<meta content="Michael Qiu" name="author"/>
<link href="https://gitmichaelqiu.github.io/curricula/ml-for-beginners/8-Reinforcement/1-QLearning/" rel="canonical"/>
<link href="../" rel="prev"/>
<link href="../2-Gym/" rel="next"/>
<link href="../../../../images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.34" name="generator"/>
<title>Q-Learning - Michael Qiu's Blog</title>
<link href="../../../../assets/stylesheets/main.35f28582.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css" rel="stylesheet"/>
<script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#introduction-to-reinforcement-learning-and-q-learning">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Michael Qiu's Blog" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Michael Qiu's Blog">
<img alt="logo" src="../../../../assets/logo-MK-round-circle-auto.svg"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Michael Qiu's Blog
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Q-Learning
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19.8 5.67A9.8 9.8 0 0 1 22 11h-2.06c-.2-1.43-.78-2.78-1.68-3.9zM13 2.05c1.96.19 3.81.95 5.33 2.21L16.9 5.69A8 8 0 0 0 13 4.05zm-2 .01c-1.96.2-3.81.97-5.33 2.21L7.1 5.69A8 8 0 0 1 11 4.06zM4.26 5.67l1.37 1.39v.04A8 8 0 0 0 4 11H2c.21-1.96 1-3.82 2.26-5.33M2 14v5l1.6-1.6C5.38 20.17 8.47 22 12 22c4.82 0 8.87-3.45 9.8-8h-2.05c-.89 3.45-4.03 6-7.75 6-2.95 0-5.61-1.61-7-4l2-2zm10 3 1.56-3.42L17 12l-3.44-1.56L12 7l-1.57 3.44L7 12l3.43 1.58z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="white" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/gitmichaelqiu/gitmichaelqiu.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    gitmichaelqiu.github.io
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../..">
          
  
  Home

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../algorithms/gcd-lcm/">
          
  
  Algorithms

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../data-structures/binary-heap/">
          
  
  Data Structures

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../oi-tips/elapsed-time/">
          
  
  OI Tips

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../academic-notes/calculus/limit/">
          
  
  Academic Notes

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../../../ai-for-beginners/">
          
  
  Curricula

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../blog/">
          
  
  Blog

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Michael Qiu's Blog" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Michael Qiu's Blog">
<img alt="logo" src="../../../../assets/logo-MK-round-circle-auto.svg"/>
</a>
    Michael Qiu's Blog
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/gitmichaelqiu/gitmichaelqiu.github.io" title="Go to repository">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    gitmichaelqiu.github.io
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
<span class="md-ellipsis">
    Home
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Home
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
<span class="md-ellipsis">
    About
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../my-projects/my-projects/">
<span class="md-ellipsis">
    My Projects
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../some-websites/">
<span class="md-ellipsis">
    Some Websites
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Algorithms
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Algorithms
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/gcd-lcm/">
<span class="md-ellipsis">
    GCD &amp; LCM
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
<span class="md-ellipsis">
    Prime
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
            Prime
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/prime/euler-sieve/">
<span class="md-ellipsis">
    Euler Sieve
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
<span class="md-ellipsis">
    Search
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
            Search
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/search/a-star/">
<span class="md-ellipsis">
    A*
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4" id="__nav_2_4_label" tabindex="0">
<span class="md-ellipsis">
    Shortest Path
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
            Shortest Path
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/shortest-path/bellman-ford/">
<span class="md-ellipsis">
    Bellman Ford
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/shortest-path/dijkstra/">
<span class="md-ellipsis">
    Dijkstra (prioirty_queue)
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/shortest-path/floyd/">
<span class="md-ellipsis">
    Floyd
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/shortest-path/spfa/">
<span class="md-ellipsis">
    SPFA
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5" id="__nav_2_5_label" tabindex="0">
<span class="md-ellipsis">
    Sort
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
            Sort
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/sort/sort-overview/">
<span class="md-ellipsis">
    Sort Overview
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../algorithms/quick-pow/">
<span class="md-ellipsis">
    Quick Pow
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
<span class="md-ellipsis">
    Data Structures
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
            Data Structures
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/binary-heap/">
<span class="md-ellipsis">
    Binary Heap
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/disjoint-set-union/">
<span class="md-ellipsis">
    Disjoint Set Union
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/segment-tree/">
<span class="md-ellipsis">
    Segment Tree
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/sparse-table/">
<span class="md-ellipsis">
    Sparse Table
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/stack/">
<span class="md-ellipsis">
    Stack
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Tree
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_3_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_3_6">
<span class="md-nav__icon md-icon"></span>
            Tree
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../data-structures/tree/binary-tree-traversals/">
<span class="md-ellipsis">
    Binary Tree Traversals
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
<span class="md-ellipsis">
    OI Tips
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_4_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
            OI Tips
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../oi-tips/elapsed-time/">
<span class="md-ellipsis">
    Elapsed Time Measurement
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../oi-tips/file-read-and-write/">
<span class="md-ellipsis">
    File Read &amp; Write
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../oi-tips/gcc-optimize/">
<span class="md-ellipsis">
    GCC Optimize
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../oi-tips/accelerate-ios/">
<span class="md-ellipsis">
    iostream Acceleration
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../oi-tips/qread-and-qwrite/">
<span class="md-ellipsis">
    Quick Read &amp; Write
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
<span class="md-ellipsis">
    Academic Notes
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
            Academic Notes
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_1" id="__nav_5_1_label" tabindex="0">
<span class="md-ellipsis">
    Calculus
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_1">
<span class="md-nav__icon md-icon"></span>
            Calculus
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../academic-notes/calculus/limit/">
<span class="md-ellipsis">
    Limit
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../academic-notes/calculus/differentiation/">
<span class="md-ellipsis">
    Differentiation
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../academic-notes/calculus/fundamental-calculus/">
<span class="md-ellipsis">
    Fundamental Calculus
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2" id="__nav_5_2_label" tabindex="0">
<span class="md-ellipsis">
    Chinese
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_5_2">
<span class="md-nav__icon md-icon"></span>
            Chinese
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2_1" id="__nav_5_2_1_label" tabindex="0">
<span class="md-ellipsis">
    初中
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_1_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_2_1">
<span class="md-nav__icon md-icon"></span>
            初中
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../academic-notes/chinese/junior-notes/geography/">
<span class="md-ellipsis">
    初中地理总结
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_5_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_5_2_2" id="__nav_5_2_2_label" tabindex="0">
<span class="md-ellipsis">
    高中
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_5_2_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_5_2_2">
<span class="md-nav__icon md-icon"></span>
            高中
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../academic-notes/chinese/senior-high-school/sets/">
<span class="md-ellipsis">
    集合
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-ellipsis">
    Curricula
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            Curricula
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1" id="__nav_6_1_label" tabindex="0">
<span class="md-ellipsis">
    AI For Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_1">
<span class="md-nav__icon md-icon"></span>
            AI For Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/1-Intro/">
<span class="md-ellipsis">
    Lesson 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/2-Symbolic/">
<span class="md-ellipsis">
    Lesson 2
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1_4" id="__nav_6_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 3
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_4_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_1_4">
<span class="md-nav__icon md-icon"></span>
            Lesson 3
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/3-NeuralNetworks/">
<span class="md-ellipsis">
    Intro
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/3-NeuralNetworks/03-Perceptron/">
<span class="md-ellipsis">
    Perceptron
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/3-NeuralNetworks/04-OwnFramework/">
<span class="md-ellipsis">
    Own Framework
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/3-NeuralNetworks/05-Frameworks/">
<span class="md-ellipsis">
    Frameworks
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/4-ComputerVision/">
<span class="md-ellipsis">
    Lesson 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/5-NLP/">
<span class="md-ellipsis">
    Lesson 5
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_1_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_1_7" id="__nav_6_1_7_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 6
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_1_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_1_7">
<span class="md-nav__icon md-icon"></span>
            Lesson 6
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/6-Other/21-GeneticAlgorithms/">
<span class="md-ellipsis">
    Genetic Algorithms
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/6-Other/22-DeepRL/">
<span class="md-ellipsis">
    Deep RL
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/6-Other/23-MultiagentSystems/">
<span class="md-ellipsis">
    Multi-Agent Systems
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/7-Ethics/">
<span class="md-ellipsis">
    Lesson 7
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ai-for-beginners/X-Extras/X1-MultiModal/">
<span class="md-ellipsis">
    Lesson X
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_2" id="__nav_6_2_label" tabindex="0">
<span class="md-ellipsis">
    Generative AI for Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_2">
<span class="md-nav__icon md-icon"></span>
            Generative AI for Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/01-introduction-to-genai/">
<span class="md-ellipsis">
    Lesson 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/02-exploring-and-comparing-different-llms/">
<span class="md-ellipsis">
    Lesson 2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/03-using-generative-ai-responsibly/">
<span class="md-ellipsis">
    Lesson 3
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/04-prompt-engineering-fundamentals/">
<span class="md-ellipsis">
    Lesson 4
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/05-advanced-prompts/">
<span class="md-ellipsis">
    Lesson 5
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/06-text-generation-apps/">
<span class="md-ellipsis">
    Lesson 6
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/07-building-chat-applications/">
<span class="md-ellipsis">
    Lesson 7
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/08-building-search-applications/">
<span class="md-ellipsis">
    Lesson 8
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/09-building-image-applications/">
<span class="md-ellipsis">
    Lesson 9
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/10-building-low-code-ai-applications/">
<span class="md-ellipsis">
    Lesson 10
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/11-integrating-with-function-calling/">
<span class="md-ellipsis">
    Lesson 11
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/12-designing-ux-for-ai-applications/">
<span class="md-ellipsis">
    Lesson 12
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/13-securing-ai-applications/">
<span class="md-ellipsis">
    Lesson 13
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/14-the-generative-ai-application-lifecycle/">
<span class="md-ellipsis">
    Lesson 14
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/15-rag-and-vector-databases/">
<span class="md-ellipsis">
    Lesson 15
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/16-open-source-models/">
<span class="md-ellipsis">
    Lesson 16
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/17-ai-agents/">
<span class="md-ellipsis">
    Lesson 17
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/18-fine-tuning/">
<span class="md-ellipsis">
    Lesson 18
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/19-slm/">
<span class="md-ellipsis">
    Lesson 19
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/20-mistral/">
<span class="md-ellipsis">
    Lesson 20
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../generative-ai-for-beginners/21-meta/">
<span class="md-ellipsis">
    Lesson 21
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3" id="__nav_6_3_label" tabindex="0">
<span class="md-ellipsis">
    ML for Beginners
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_3">
<span class="md-nav__icon md-icon"></span>
            ML for Beginners
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../">
<span class="md-ellipsis">
    Overview
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_2" id="__nav_6_3_2_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 1
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_2_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_2">
<span class="md-nav__icon md-icon"></span>
            Lesson 1
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1-Introduction/1-intro-to-ML/">
<span class="md-ellipsis">
    Intro to ML
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1-Introduction/2-history-of-ML/">
<span class="md-ellipsis">
    History of ML
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1-Introduction/3-fairness/">
<span class="md-ellipsis">
    Fairness
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../1-Introduction/4-techniques-of-ML/">
<span class="md-ellipsis">
    Techniques of ML
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_3" id="__nav_6_3_3_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 2
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_3_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_3">
<span class="md-nav__icon md-icon"></span>
            Lesson 2
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../2-Regression/">
<span class="md-ellipsis">
    Regression
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2-Regression/1-Tools/">
<span class="md-ellipsis">
    Tools
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2-Regression/2-Data/">
<span class="md-ellipsis">
    Data
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2-Regression/3-Linear/">
<span class="md-ellipsis">
    Linear
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../2-Regression/4-Logistic/">
<span class="md-ellipsis">
    Logistic
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../3-Web-App/">
<span class="md-ellipsis">
    Lesson 3
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_5" id="__nav_6_3_5_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 4
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_5_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_5">
<span class="md-nav__icon md-icon"></span>
            Lesson 4
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../4-Classification/">
<span class="md-ellipsis">
    Classification
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../4-Classification/1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../4-Classification/2-Classifiers-1/">
<span class="md-ellipsis">
    Classifiers 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../4-Classification/3-Classifiers-2/">
<span class="md-ellipsis">
    Classifiers 2
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../4-Classification/4-Applied/">
<span class="md-ellipsis">
    Applied
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_6" id="__nav_6_3_6_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 5
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_6_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_6">
<span class="md-nav__icon md-icon"></span>
            Lesson 5
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../5-Clustering/">
<span class="md-ellipsis">
    Clustering
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../5-Clustering/1-Visualize/">
<span class="md-ellipsis">
    Visualize
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../5-Clustering/2-K-Means/">
<span class="md-ellipsis">
    K Means
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_7" id="__nav_6_3_7_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 6
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_7_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_7">
<span class="md-nav__icon md-icon"></span>
            Lesson 6
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/">
<span class="md-ellipsis">
    NLP
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/1-Introduction-to-NLP/">
<span class="md-ellipsis">
    Introduction to NLP
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/2-Tasks/">
<span class="md-ellipsis">
    Tasks
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/3-Translation-Sentiment/">
<span class="md-ellipsis">
    Translation Sentiment
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/4-Hotel-Reviews-1/">
<span class="md-ellipsis">
    Hotel Reviews 1
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../6-NLP/5-Hotel-Reviews-2/">
<span class="md-ellipsis">
    Hotel Reviews 2
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_8" id="__nav_6_3_8_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 7
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_8_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_8">
<span class="md-nav__icon md-icon"></span>
            Lesson 7
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../7-TimeSeries/">
<span class="md-ellipsis">
    Time Series
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../7-TimeSeries/1-Introduction/">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../7-TimeSeries/2-ARIMA/">
<span class="md-ellipsis">
    ARIMA
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../7-TimeSeries/3-SVR/">
<span class="md-ellipsis">
    SVR
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_3_9" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_9" id="__nav_6_3_9_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 8
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_6_3_9_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_9">
<span class="md-nav__icon md-icon"></span>
            Lesson 8
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../">
<span class="md-ellipsis">
    Reinforcement
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Q-Learning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Q-Learning
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction-to-reinforcement-learning-and-q-learning">
<span class="md-ellipsis">
      Introduction to Reinforcement Learning and Q-Learning
    </span>
</a>
<nav aria-label="Introduction to Reinforcement Learning and Q-Learning" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-lecture-quiz">
<span class="md-ellipsis">
      Pre-lecture quiz
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites-and-setup">
<span class="md-ellipsis">
      Prerequisites and Setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-environment">
<span class="md-ellipsis">
      The environment
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#actions-and-policy">
<span class="md-ellipsis">
      Actions and policy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#random-walk">
<span class="md-ellipsis">
      Random walk
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#reward-function">
<span class="md-ellipsis">
      Reward function
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#q-learning">
<span class="md-ellipsis">
      Q-Learning
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#essence-of-q-learning-bellman-equation">
<span class="md-ellipsis">
      Essence of Q-Learning: Bellman Equation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-algorithm">
<span class="md-ellipsis">
      Learning Algorithm
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exploit-vs-explore">
<span class="md-ellipsis">
      Exploit vs. explore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python-implementation">
<span class="md-ellipsis">
      Python implementation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checking-the-policy">
<span class="md-ellipsis">
      Checking the policy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge">
<span class="md-ellipsis">
      🚀Challenge
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#navigation">
<span class="md-ellipsis">
      Navigation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#investigating-the-learning-process">
<span class="md-ellipsis">
      Investigating the learning process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#post-lecture-quiz">
<span class="md-ellipsis">
      Post-lecture quiz
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#assignment">
<span class="md-ellipsis">
      Assignment
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../2-Gym/">
<span class="md-ellipsis">
    Gym
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_6_3_10" type="checkbox"/>
<label class="md-nav__link" for="__nav_6_3_10" id="__nav_6_3_10_label" tabindex="0">
<span class="md-ellipsis">
    Lesson 9
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_6_3_10_label" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_6_3_10">
<span class="md-nav__icon md-icon"></span>
            Lesson 9
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../9-Real-World/">
<span class="md-ellipsis">
    Real World
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../9-Real-World/1-Applications/">
<span class="md-ellipsis">
    Applications
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../9-Real-World/2-Debugging-ML-Models/">
<span class="md-ellipsis">
    Debugging ML Models
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
<span class="md-ellipsis">
    Blog
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_7">
<span class="md-nav__icon md-icon"></span>
            Blog
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/">
<span class="md-ellipsis">
    Index
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_2" id="__nav_7_2_label" tabindex="0">
<span class="md-ellipsis">
    Archive
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_2">
<span class="md-nav__icon md-icon"></span>
            Archive
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/archive/2024/">
<span class="md-ellipsis">
    2024
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" id="__nav_7_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_7_3" id="__nav_7_3_label" tabindex="0">
<span class="md-ellipsis">
    Categories
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_7_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_7_3">
<span class="md-nav__icon md-icon"></span>
            Categories
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../blog/category/ai/">
<span class="md-ellipsis">
    Ai
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction-to-reinforcement-learning-and-q-learning">
<span class="md-ellipsis">
      Introduction to Reinforcement Learning and Q-Learning
    </span>
</a>
<nav aria-label="Introduction to Reinforcement Learning and Q-Learning" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#pre-lecture-quiz">
<span class="md-ellipsis">
      Pre-lecture quiz
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites-and-setup">
<span class="md-ellipsis">
      Prerequisites and Setup
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#the-environment">
<span class="md-ellipsis">
      The environment
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#actions-and-policy">
<span class="md-ellipsis">
      Actions and policy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#random-walk">
<span class="md-ellipsis">
      Random walk
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#reward-function">
<span class="md-ellipsis">
      Reward function
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#q-learning">
<span class="md-ellipsis">
      Q-Learning
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#essence-of-q-learning-bellman-equation">
<span class="md-ellipsis">
      Essence of Q-Learning: Bellman Equation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#learning-algorithm">
<span class="md-ellipsis">
      Learning Algorithm
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#exploit-vs-explore">
<span class="md-ellipsis">
      Exploit vs. explore
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#python-implementation">
<span class="md-ellipsis">
      Python implementation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checking-the-policy">
<span class="md-ellipsis">
      Checking the policy
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenge">
<span class="md-ellipsis">
      🚀Challenge
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#navigation">
<span class="md-ellipsis">
      Navigation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#investigating-the-learning-process">
<span class="md-ellipsis">
      Investigating the learning process
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#post-lecture-quiz">
<span class="md-ellipsis">
      Post-lecture quiz
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#assignment">
<span class="md-ellipsis">
      Assignment
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1>Q-Learning</h1>
<div><h2 id="introduction-to-reinforcement-learning-and-q-learning">Introduction to Reinforcement Learning and Q-Learning<a class="headerlink" href="#introduction-to-reinforcement-learning-and-q-learning" title="Permanent link">¶</a></h2>
<p><img alt="Summary of reinforcement in machine learning in a sketchnote" src="../../sketchnotes/ml-reinforcement.png"/></p>
<blockquote>
<p>Sketchnote by <a href="https://www.twitter.com/girlie_mac">Tomomi Imura</a></p>
</blockquote>
<p>Reinforcement learning involves three important concepts: the agent, some states, and a set of actions per state. By executing an action in a specified state, the agent is given a reward. Again imagine the computer game Super Mario. You are Mario, you are in a game level, standing next to a cliff edge. Above you is a coin. You being Mario, in a game level, at a specific position ... that's your state. Moving one step to the right (an action) will take you over the edge, and that would give you a low numerical score. However, pressing the jump button would let you score a point and you would stay alive. That's a positive outcome and that should award you a positive numerical score.</p>
<p>By using reinforcement learning and a simulator (the game), you can learn how to play the game to maximize the reward which is staying alive and scoring as many points as possible.</p>
<p><a href="https://www.youtube.com/watch?v=lDq_en8RNOo"><img alt="Intro to Reinforcement Learning" src="https://img.youtube.com/vi/lDq_en8RNOo/0.jpg"/></a></p>
<blockquote>
<p>🎥 Click the image above to hear Dmitry discuss Reinforcement Learning</p>
</blockquote>
<h3 id="pre-lecture-quiz"><a href="https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/45/">Pre-lecture quiz</a><a class="headerlink" href="#pre-lecture-quiz" title="Permanent link">¶</a></h3>
<h3 id="prerequisites-and-setup">Prerequisites and Setup<a class="headerlink" href="#prerequisites-and-setup" title="Permanent link">¶</a></h3>
<p>In this lesson, we will be experimenting with some code in Python. You should be able to run the Jupyter Notebook code from this lesson, either on your computer or somewhere in the cloud.</p>
<p>You can open <a href="https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/notebook.ipynb">the lesson notebook</a> and walk through this lesson to build.</p>
<blockquote>
<p><strong>Note:</strong> If you are opening this code from the cloud, you also need to fetch the <a href="https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py"><code>rlboard.py</code></a> file, which is used in the notebook code. Add it to the same directory as the notebook.</p>
</blockquote>
<h3 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">¶</a></h3>
<p>In this lesson, we will explore the world of <strong><a href="https://en.wikipedia.org/wiki/Peter_and_the_Wolf">Peter and the Wolf</a></strong>, inspired by a musical fairy tale by a Russian composer, <a href="https://en.wikipedia.org/wiki/Sergei_Prokofiev">Sergei Prokofiev</a>. We will use <strong>Reinforcement Learning</strong> to let Peter explore his environment, collect tasty apples and avoid meeting the wolf.</p>
<p><strong>Reinforcement Learning</strong> (RL) is a learning technique that allows us to learn an optimal behavior of an <strong>agent</strong> in some <strong>environment</strong> by running many experiments. An agent in this environment should have some <strong>goal</strong>, defined by a <strong>reward function</strong>.</p>
<h3 id="the-environment">The environment<a class="headerlink" href="#the-environment" title="Permanent link">¶</a></h3>
<p>For simplicity, let's consider Peter's world to be a square board of size <code>width</code> x <code>height</code>, like this:</p>
<p><img alt="Peter's Environment" src="images/environment.png"/></p>
<p>Each cell in this board can either be:</p>
<ul>
<li><strong>ground</strong>, on which Peter and other creatures can walk.</li>
<li><strong>water</strong>, on which you obviously cannot walk.</li>
<li>a <strong>tree</strong> or <strong>grass</strong>, a place where you can rest.</li>
<li>an <strong>apple</strong>, which represents something Peter would be glad to find in order to feed himself.</li>
<li>a <strong>wolf</strong>, which is dangerous and should be avoided.</li>
</ul>
<p>There is a separate Python module, <a href="https://github.com/microsoft/ML-For-Beginners/blob/main/8-Reinforcement/1-QLearning/rlboard.py"><code>rlboard.py</code></a>, which contains the code to work with this environment. Because this code is not important for understanding our concepts, we will import the module and use it to create the sample board (code block 1):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">rlboard</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span><span class="mi">8</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="n">m</span> <span class="o">=</span> <span class="n">Board</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">)</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">m</span><span class="o">.</span><span class="n">randomize</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">13</span><span class="p">)</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">m</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</span></code></pre></div>
<p>This code should print a picture of the environment similar to the one above.</p>
<h3 id="actions-and-policy">Actions and policy<a class="headerlink" href="#actions-and-policy" title="Permanent link">¶</a></h3>
<p>In our example, Peter's goal would be able to find an apple, while avoiding the wolf and other obstacles. To do this, he can essentially walk around until he finds an apple.</p>
<p>Therefore, at any position, he can choose between one of the following actions: up, down, left and right.</p>
<p>We will define those actions as a dictionary, and map them to pairs of corresponding coordinate changes. For example, moving right (<code>R</code>) would correspond to a pair <code>(1,0)</code>. (code block 2):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">actions</span> <span class="o">=</span> <span class="p">{</span> <span class="s2">"U"</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s2">"D"</span> <span class="p">:</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="s2">"L"</span> <span class="p">:</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="s2">"R"</span> <span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="p">}</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="n">action_idx</span> <span class="o">=</span> <span class="p">{</span> <span class="n">a</span> <span class="p">:</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="p">}</span>
</span></code></pre></div>
<p>To sum up, the strategy and goal of this scenario are as follows:</p>
<ul>
<li>
<p><strong>The strategy</strong>, of our agent (Peter) is defined by a so-called <strong>policy</strong>. A policy is a function that returns the action at any given state. In our case, the state of the problem is represented by the board, including the current position of the player.</p>
</li>
<li>
<p><strong>The goal</strong>, of reinforcement learning is to eventually learn a good policy that will allow us to solve the problem efficiently. However, as a baseline, let's consider the simplest policy called <strong>random walk</strong>.</p>
</li>
</ul>
<h3 id="random-walk">Random walk<a class="headerlink" href="#random-walk" title="Permanent link">¶</a></h3>
<p>Let's first solve our problem by implementing a random walk strategy. With random walk, we will randomly choose the next action from the allowed actions, until we reach the apple (code block 3).</p>
<ol>
<li>
<p>Implement the random walk with the below code:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="k">def</span> <span class="nf">random_policy</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a>    <span class="k">return</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">actions</span><span class="p">))</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">policy</span><span class="p">,</span><span class="n">start_position</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a>    <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># number of steps</span>
</span><span id="__span-2-6"><a href="#__codelineno-2-6" id="__codelineno-2-6" name="__codelineno-2-6"></a>    <span class="c1"># set initial position</span>
</span><span id="__span-2-7"><a href="#__codelineno-2-7" id="__codelineno-2-7" name="__codelineno-2-7"></a>    <span class="k">if</span> <span class="n">start_position</span><span class="p">:</span>
</span><span id="__span-2-8"><a href="#__codelineno-2-8" id="__codelineno-2-8" name="__codelineno-2-8"></a>        <span class="n">m</span><span class="o">.</span><span class="n">human</span> <span class="o">=</span> <span class="n">start_position</span> 
</span><span id="__span-2-9"><a href="#__codelineno-2-9" id="__codelineno-2-9" name="__codelineno-2-9"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-2-10"><a href="#__codelineno-2-10" id="__codelineno-2-10" name="__codelineno-2-10"></a>        <span class="n">m</span><span class="o">.</span><span class="n">random_start</span><span class="p">()</span>
</span><span id="__span-2-11"><a href="#__codelineno-2-11" id="__codelineno-2-11" name="__codelineno-2-11"></a>    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-2-12"><a href="#__codelineno-2-12" id="__codelineno-2-12" name="__codelineno-2-12"></a>        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">at</span><span class="p">()</span> <span class="o">==</span> <span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">apple</span><span class="p">:</span>
</span><span id="__span-2-13"><a href="#__codelineno-2-13" id="__codelineno-2-13" name="__codelineno-2-13"></a>            <span class="k">return</span> <span class="n">n</span> <span class="c1"># success!</span>
</span><span id="__span-2-14"><a href="#__codelineno-2-14" id="__codelineno-2-14" name="__codelineno-2-14"></a>        <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">at</span><span class="p">()</span> <span class="ow">in</span> <span class="p">[</span><span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">wolf</span><span class="p">,</span> <span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">water</span><span class="p">]:</span>
</span><span id="__span-2-15"><a href="#__codelineno-2-15" id="__codelineno-2-15" name="__codelineno-2-15"></a>            <span class="k">return</span> <span class="o">-</span><span class="mi">1</span> <span class="c1"># eaten by wolf or drowned</span>
</span><span id="__span-2-16"><a href="#__codelineno-2-16" id="__codelineno-2-16" name="__codelineno-2-16"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-2-17"><a href="#__codelineno-2-17" id="__codelineno-2-17" name="__codelineno-2-17"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">policy</span><span class="p">(</span><span class="n">m</span><span class="p">)]</span>
</span><span id="__span-2-18"><a href="#__codelineno-2-18" id="__codelineno-2-18" name="__codelineno-2-18"></a>            <span class="n">new_pos</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">move_pos</span><span class="p">(</span><span class="n">m</span><span class="o">.</span><span class="n">human</span><span class="p">,</span><span class="n">a</span><span class="p">)</span>
</span><span id="__span-2-19"><a href="#__codelineno-2-19" id="__codelineno-2-19" name="__codelineno-2-19"></a>            <span class="k">if</span> <span class="n">m</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span> <span class="ow">and</span> <span class="n">m</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">new_pos</span><span class="p">)</span><span class="o">!=</span><span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">water</span><span class="p">:</span>
</span><span id="__span-2-20"><a href="#__codelineno-2-20" id="__codelineno-2-20" name="__codelineno-2-20"></a>                <span class="n">m</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># do the actual move</span>
</span><span id="__span-2-21"><a href="#__codelineno-2-21" id="__codelineno-2-21" name="__codelineno-2-21"></a>                <span class="k">break</span>
</span><span id="__span-2-22"><a href="#__codelineno-2-22" id="__codelineno-2-22" name="__codelineno-2-22"></a>        <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="__span-2-23"><a href="#__codelineno-2-23" id="__codelineno-2-23" name="__codelineno-2-23"></a>
</span><span id="__span-2-24"><a href="#__codelineno-2-24" id="__codelineno-2-24" name="__codelineno-2-24"></a><span class="n">walk</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">random_policy</span><span class="p">)</span>
</span></code></pre></div>
<p>The call to <code>walk</code> should return the length of the corresponding path, which can vary from one run to another. </p>
</li>
<li>
<p>Run the walk experiment a number of times (say, 100), and print the resulting statistics (code block 4):</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="k">def</span> <span class="nf">print_statistics</span><span class="p">(</span><span class="n">policy</span><span class="p">):</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a>    <span class="n">s</span><span class="p">,</span><span class="n">w</span><span class="p">,</span><span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a>    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a>        <span class="n">z</span> <span class="o">=</span> <span class="n">walk</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">policy</span><span class="p">)</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a>        <span class="k">if</span> <span class="n">z</span><span class="o">&lt;</span><span class="mi">0</span><span class="p">:</span>
</span><span id="__span-3-6"><a href="#__codelineno-3-6" id="__codelineno-3-6" name="__codelineno-3-6"></a>            <span class="n">w</span><span class="o">+=</span><span class="mi">1</span>
</span><span id="__span-3-7"><a href="#__codelineno-3-7" id="__codelineno-3-7" name="__codelineno-3-7"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-3-8"><a href="#__codelineno-3-8" id="__codelineno-3-8" name="__codelineno-3-8"></a>            <span class="n">s</span> <span class="o">+=</span> <span class="n">z</span>
</span><span id="__span-3-9"><a href="#__codelineno-3-9" id="__codelineno-3-9" name="__codelineno-3-9"></a>            <span class="n">n</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-3-10"><a href="#__codelineno-3-10" id="__codelineno-3-10" name="__codelineno-3-10"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Average path length = </span><span class="si">{</span><span class="n">s</span><span class="o">/</span><span class="n">n</span><span class="si">}</span><span class="s2">, eaten by wolf: </span><span class="si">{</span><span class="n">w</span><span class="si">}</span><span class="s2"> times"</span><span class="p">)</span>
</span><span id="__span-3-11"><a href="#__codelineno-3-11" id="__codelineno-3-11" name="__codelineno-3-11"></a>
</span><span id="__span-3-12"><a href="#__codelineno-3-12" id="__codelineno-3-12" name="__codelineno-3-12"></a><span class="n">print_statistics</span><span class="p">(</span><span class="n">random_policy</span><span class="p">)</span>
</span></code></pre></div>
<p>Note that the average length of a path is around 30-40 steps, which is quite a lot, given the fact that the average distance to the nearest apple is around 5-6 steps.</p>
<p>You can also see what Peter's movement looks like during the random walk:</p>
<p><img alt="Peter's Random Walk" src="images/random_walk.gif"/></p>
</li>
</ol>
<h3 id="reward-function">Reward function<a class="headerlink" href="#reward-function" title="Permanent link">¶</a></h3>
<p>To make our policy more intelligent, we need to understand which moves are "better" than others. To do this, we need to define our goal.</p>
<p>The goal can be defined in terms of a <strong>reward function</strong>, which will return some score value for each state. The higher the number, the better the reward function. (code block 5)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="n">move_reward</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="n">goal_reward</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">end_reward</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="k">def</span> <span class="nf">reward</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a>    <span class="n">pos</span> <span class="o">=</span> <span class="n">pos</span> <span class="ow">or</span> <span class="n">m</span><span class="o">.</span><span class="n">human</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">m</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">pos</span><span class="p">):</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a>        <span class="k">return</span> <span class="n">end_reward</span>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">water</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">wolf</span><span class="p">:</span>
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a>        <span class="k">return</span> <span class="n">end_reward</span>
</span><span id="__span-4-12"><a href="#__codelineno-4-12" id="__codelineno-4-12" name="__codelineno-4-12"></a>    <span class="k">if</span> <span class="n">x</span><span class="o">==</span><span class="n">Board</span><span class="o">.</span><span class="n">Cell</span><span class="o">.</span><span class="n">apple</span><span class="p">:</span>
</span><span id="__span-4-13"><a href="#__codelineno-4-13" id="__codelineno-4-13" name="__codelineno-4-13"></a>        <span class="k">return</span> <span class="n">goal_reward</span>
</span><span id="__span-4-14"><a href="#__codelineno-4-14" id="__codelineno-4-14" name="__codelineno-4-14"></a>    <span class="k">return</span> <span class="n">move_reward</span>
</span></code></pre></div>
<p>An interesting thing about reward functions is that in most cases, <em>we are only given a substantial reward at the end of the game</em>. This means that our algorithm should somehow remember "good" steps that lead to a positive reward at the end, and increase their importance. Similarly, all moves that lead to bad results should be discouraged.</p>
<h3 id="q-learning">Q-Learning<a class="headerlink" href="#q-learning" title="Permanent link">¶</a></h3>
<p>An algorithm that we will discuss here is called <strong>Q-Learning</strong>. In this algorithm, the policy is defined by a function (or a data structure) called a <strong>Q-Table</strong>. It records the "goodness" of each of the actions in a given state.</p>
<p>It is called a Q-Table because it is often convenient to represent it as a table, or multi-dimensional array. Since our board has dimensions <code>width</code> x <code>height</code>, we can represent the Q-Table using a numpy array with shape <code>width</code> x <code>height</code> x <code>len(actions)</code>: (code block 6)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="n">Q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)),</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span><span class="o">*</span><span class="mf">1.0</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
</span></code></pre></div>
<p>Notice that we initialize all the values of the Q-Table with an equal value, in our case - 0.25. This corresponds to the "random walk" policy, because all moves in each state are equally good. We can pass the Q-Table to the <code>plot</code> function in order to visualize the table on the board: <code>m.plot(Q)</code>.</p>
<p><img alt="Peter's Environment" src="images/env_init.png"/></p>
<p>In the center of each cell there is an "arrow" that indicates the preferred direction of movement. Since all directions are equal, a dot is displayed.</p>
<p>Now we need to run the simulation, explore our environment, and learn a better distribution of Q-Table values, which will allow us to find the path to the apple much faster.</p>
<h3 id="essence-of-q-learning-bellman-equation">Essence of Q-Learning: Bellman Equation<a class="headerlink" href="#essence-of-q-learning-bellman-equation" title="Permanent link">¶</a></h3>
<p>Once we start moving, each action will have a corresponding reward, i.e. we can theoretically select the next action based on the highest immediate reward. However, in most states, the move will not achieve our goal of reaching the apple, and thus we cannot immediately decide which direction is better.</p>
<blockquote>
<p>Remember that it is not the immediate result that matters, but rather the final result, which we will obtain at the end of the simulation.</p>
</blockquote>
<p>In order to account for this delayed reward, we need to use the principles of <strong><a href="https://en.wikipedia.org/wiki/Dynamic_programming">dynamic programming</a></strong>, which allow us to think about out problem recursively.</p>
<p>Suppose we are now at the state <em>s</em>, and we want to move to the next state <em>s'</em>. By doing so, we will receive the immediate reward <em>r(s,a)</em>, defined by the reward function, plus some future reward. If we suppose that our Q-Table correctly reflects the "attractiveness" of each action, then at state <em>s'</em> we will chose an action <em>a</em> that corresponds to maximum value of <em>Q(s',a')</em>. Thus, the best possible future reward we could get at state <em>s</em> will be defined as <code>max</code><sub>a'</sub><em>Q(s',a')</em> (maximum here is computed over all possible actions <em>a'</em> at state <em>s'</em>).</p>
<p>This gives the <strong>Bellman formula</strong> for calculating the value of the Q-Table at state <em>s</em>, given action <em>a</em>:</p>
<p><img src="images/bellman-equation.png"/></p>
<p>Here γ is the so-called <strong>discount factor</strong> that determines to which extent you should prefer the current reward over the future reward and vice versa.</p>
<h3 id="learning-algorithm">Learning Algorithm<a class="headerlink" href="#learning-algorithm" title="Permanent link">¶</a></h3>
<p>Given the equation above, we can now write pseudo-code for our learning algorithm:</p>
<ul>
<li>Initialize Q-Table Q with equal numbers for all states and actions</li>
<li>Set learning rate α ← 1</li>
<li>Repeat simulation many times</li>
<li>Start at random position</li>
<li>Repeat
        1. Select an action <em>a</em> at state <em>s</em>
        2. Execute action by moving to a new state <em>s'</em>
        3. If we encounter end-of-game condition, or total reward is too small - exit simulation<br/>
        4. Compute reward <em>r</em> at the new state
        5. Update Q-Function according to Bellman equation: <em>Q(s,a)</em> ← <em>(1-α)Q(s,a)+α(r+γ max<sub>a'</sub>Q(s',a'))</em>
        6. <em>s</em> ← <em>s'</em>
        7. Update the total reward and decrease α.</li>
</ul>
<h3 id="exploit-vs-explore">Exploit vs. explore<a class="headerlink" href="#exploit-vs-explore" title="Permanent link">¶</a></h3>
<p>In the algorithm above, we did not specify how exactly we should choose an action at step 2.1. If we are choosing the action randomly, we will randomly <strong>explore</strong> the environment, and we are quite likely to die often as well as explore areas where we would not normally go. An alternative approach would be to <strong>exploit</strong> the Q-Table values that we already know, and thus to choose the best action (with higher Q-Table value) at state <em>s</em>. This, however, will prevent us from exploring other states, and it's likely we might not find the optimal solution.</p>
<p>Thus, the best approach is to strike a balance between exploration and exploitation. This can be done by choosing the action at state <em>s</em> with probabilities proportional to values in the Q-Table. In the beginning, when Q-Table values are all the same, it would correspond to a random selection, but as we learn more about our environment, we would be more likely to follow the optimal route while allowing the agent to choose the unexplored path once in a while.</p>
<h3 id="python-implementation">Python implementation<a class="headerlink" href="#python-implementation" title="Permanent link">¶</a></h3>
<p>We are now ready to implement the learning algorithm. Before we do that, we also need some function that will convert arbitrary numbers in the Q-Table into a vector of probabilities for corresponding actions.</p>
<ol>
<li>
<p>Create a function <code>probs()</code>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="k">def</span> <span class="nf">probs</span><span class="p">(</span><span class="n">v</span><span class="p">,</span><span class="n">eps</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">):</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">-</span><span class="n">v</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">+</span><span class="n">eps</span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a>    <span class="n">v</span> <span class="o">=</span> <span class="n">v</span><span class="o">/</span><span class="n">v</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a>    <span class="k">return</span> <span class="n">v</span>
</span></code></pre></div>
<p>We add a few <code>eps</code> to the original vector in order to avoid division by 0 in the initial case, when all components of the vector are identical.</p>
</li>
</ol>
<p>Run them learning algorithm through 5000 experiments, also called <strong>epochs</strong>: (code block 8)
</p><div class="language-python highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a>    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5000</span><span class="p">):</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a>        <span class="c1"># Pick initial point</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a>        <span class="n">m</span><span class="o">.</span><span class="n">random_start</span><span class="p">()</span>
</span><span id="__span-7-5"><a href="#__codelineno-7-5" id="__codelineno-7-5" name="__codelineno-7-5"></a>
</span><span id="__span-7-6"><a href="#__codelineno-7-6" id="__codelineno-7-6" name="__codelineno-7-6"></a>        <span class="c1"># Start travelling</span>
</span><span id="__span-7-7"><a href="#__codelineno-7-7" id="__codelineno-7-7" name="__codelineno-7-7"></a>        <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
</span><span id="__span-7-8"><a href="#__codelineno-7-8" id="__codelineno-7-8" name="__codelineno-7-8"></a>        <span class="n">cum_reward</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-7-9"><a href="#__codelineno-7-9" id="__codelineno-7-9" name="__codelineno-7-9"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-7-10"><a href="#__codelineno-7-10" id="__codelineno-7-10" name="__codelineno-7-10"></a>            <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">human</span>
</span><span id="__span-7-11"><a href="#__codelineno-7-11" id="__codelineno-7-11" name="__codelineno-7-11"></a>            <span class="n">v</span> <span class="o">=</span> <span class="n">probs</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
</span><span id="__span-7-12"><a href="#__codelineno-7-12" id="__codelineno-7-12" name="__codelineno-7-12"></a>            <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">actions</span><span class="p">),</span><span class="n">weights</span><span class="o">=</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-7-13"><a href="#__codelineno-7-13" id="__codelineno-7-13" name="__codelineno-7-13"></a>            <span class="n">dpos</span> <span class="o">=</span> <span class="n">actions</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="__span-7-14"><a href="#__codelineno-7-14" id="__codelineno-7-14" name="__codelineno-7-14"></a>            <span class="n">m</span><span class="o">.</span><span class="n">move</span><span class="p">(</span><span class="n">dpos</span><span class="p">,</span><span class="n">check_correctness</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># we allow player to move outside the board, which terminates episode</span>
</span><span id="__span-7-15"><a href="#__codelineno-7-15" id="__codelineno-7-15" name="__codelineno-7-15"></a>            <span class="n">r</span> <span class="o">=</span> <span class="n">reward</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</span><span id="__span-7-16"><a href="#__codelineno-7-16" id="__codelineno-7-16" name="__codelineno-7-16"></a>            <span class="n">cum_reward</span> <span class="o">+=</span> <span class="n">r</span>
</span><span id="__span-7-17"><a href="#__codelineno-7-17" id="__codelineno-7-17" name="__codelineno-7-17"></a>            <span class="k">if</span> <span class="n">r</span><span class="o">==</span><span class="n">end_reward</span> <span class="ow">or</span> <span class="n">cum_reward</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mi">1000</span><span class="p">:</span>
</span><span id="__span-7-18"><a href="#__codelineno-7-18" id="__codelineno-7-18" name="__codelineno-7-18"></a>                <span class="n">lpath</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</span><span id="__span-7-19"><a href="#__codelineno-7-19" id="__codelineno-7-19" name="__codelineno-7-19"></a>                <span class="k">break</span>
</span><span id="__span-7-20"><a href="#__codelineno-7-20" id="__codelineno-7-20" name="__codelineno-7-20"></a>            <span class="n">alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">n</span> <span class="o">/</span> <span class="mf">10e5</span><span class="p">)</span>
</span><span id="__span-7-21"><a href="#__codelineno-7-21" id="__codelineno-7-21" name="__codelineno-7-21"></a>            <span class="n">gamma</span> <span class="o">=</span> <span class="mf">0.5</span>
</span><span id="__span-7-22"><a href="#__codelineno-7-22" id="__codelineno-7-22" name="__codelineno-7-22"></a>            <span class="n">ai</span> <span class="o">=</span> <span class="n">action_idx</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
</span><span id="__span-7-23"><a href="#__codelineno-7-23" id="__codelineno-7-23" name="__codelineno-7-23"></a>            <span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ai</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ai</span><span class="p">]</span> <span class="o">+</span> <span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="o">+</span><span class="n">dpos</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">+</span><span class="n">dpos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
</span><span id="__span-7-24"><a href="#__codelineno-7-24" id="__codelineno-7-24" name="__codelineno-7-24"></a>            <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
</span></code></pre></div>
<p>After executing this algorithm, the Q-Table should be updated with values that define the attractiveness of different actions at each step. We can try to visualize the Q-Table by plotting a vector at each cell that will point in the desired direction of movement. For simplicity, we draw a small circle instead of an arrow head.</p>
<p><img src="images/learned.png"/></p>
<h3 id="checking-the-policy">Checking the policy<a class="headerlink" href="#checking-the-policy" title="Permanent link">¶</a></h3>
<p>Since the Q-Table lists the "attractiveness" of each action at each state, it is quite easy to use it to define the efficient navigation in our world. In the simplest case, we can select the action corresponding to the highest Q-Table value: (code block 9)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a href="#__codelineno-8-1" id="__codelineno-8-1" name="__codelineno-8-1"></a><span class="k">def</span> <span class="nf">qpolicy_strict</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="__span-8-2"><a href="#__codelineno-8-2" id="__codelineno-8-2" name="__codelineno-8-2"></a>        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">human</span>
</span><span id="__span-8-3"><a href="#__codelineno-8-3" id="__codelineno-8-3" name="__codelineno-8-3"></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">probs</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
</span><span id="__span-8-4"><a href="#__codelineno-8-4" id="__codelineno-8-4" name="__codelineno-8-4"></a>        <span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">actions</span><span class="p">)[</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>
</span><span id="__span-8-5"><a href="#__codelineno-8-5" id="__codelineno-8-5" name="__codelineno-8-5"></a>        <span class="k">return</span> <span class="n">a</span>
</span><span id="__span-8-6"><a href="#__codelineno-8-6" id="__codelineno-8-6" name="__codelineno-8-6"></a>
</span><span id="__span-8-7"><a href="#__codelineno-8-7" id="__codelineno-8-7" name="__codelineno-8-7"></a><span class="n">walk</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">qpolicy_strict</span><span class="p">)</span>
</span></code></pre></div>
<blockquote>
<p>If you try the code above several times, you may notice that sometimes it "hangs", and you need to press the STOP button in the notebook to interrupt it. This happens because there could be situations when two states "point" to each other in terms of optimal Q-Value, in which case the agents ends up moving between those states indefinitely.</p>
</blockquote>
<h3 id="challenge">🚀Challenge<a class="headerlink" href="#challenge" title="Permanent link">¶</a></h3>
<blockquote>
<p><strong>Task 1:</strong> Modify the <code>walk</code> function to limit the maximum length of path by a certain number of steps (say, 100), and watch the code above return this value from time to time.</p>
<p><strong>Task 2:</strong> Modify the <code>walk</code> function so that it does not go back to the places where it has already been previously. This will prevent <code>walk</code> from looping, however, the agent can still end up being "trapped" in a location from which it is unable to escape.</p>
</blockquote>
<h3 id="navigation">Navigation<a class="headerlink" href="#navigation" title="Permanent link">¶</a></h3>
<p>A better navigation policy would be the one that we used during training, which combines exploitation and exploration. In this policy, we will select each action with a certain probability, proportional to the values in the Q-Table. This strategy may still result in the agent returning back to a position it has already explored, but, as you can see from the code below, it results in a very short average path to the desired location (remember that <code>print_statistics</code> runs the simulation 100 times): (code block 10)</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a href="#__codelineno-9-1" id="__codelineno-9-1" name="__codelineno-9-1"></a><span class="k">def</span> <span class="nf">qpolicy</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
</span><span id="__span-9-2"><a href="#__codelineno-9-2" id="__codelineno-9-2" name="__codelineno-9-2"></a>        <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">human</span>
</span><span id="__span-9-3"><a href="#__codelineno-9-3" id="__codelineno-9-3" name="__codelineno-9-3"></a>        <span class="n">v</span> <span class="o">=</span> <span class="n">probs</span><span class="p">(</span><span class="n">Q</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">])</span>
</span><span id="__span-9-4"><a href="#__codelineno-9-4" id="__codelineno-9-4" name="__codelineno-9-4"></a>        <span class="n">a</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choices</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">actions</span><span class="p">),</span><span class="n">weights</span><span class="o">=</span><span class="n">v</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-9-5"><a href="#__codelineno-9-5" id="__codelineno-9-5" name="__codelineno-9-5"></a>        <span class="k">return</span> <span class="n">a</span>
</span><span id="__span-9-6"><a href="#__codelineno-9-6" id="__codelineno-9-6" name="__codelineno-9-6"></a>
</span><span id="__span-9-7"><a href="#__codelineno-9-7" id="__codelineno-9-7" name="__codelineno-9-7"></a><span class="n">print_statistics</span><span class="p">(</span><span class="n">qpolicy</span><span class="p">)</span>
</span></code></pre></div>
<p>After running this code, you should get a much smaller average path length than before, in the range of 3-6.</p>
<h3 id="investigating-the-learning-process">Investigating the learning process<a class="headerlink" href="#investigating-the-learning-process" title="Permanent link">¶</a></h3>
<p>As we have mentioned, the learning process is a balance between exploration and exploration of gained knowledge about the structure of problem space. We have seen that the results of learning (the ability to help an agent to find a short path to the goal) has improved, but it is also interesting to observe how the average path length behaves during the learning process:</p>
<p><img src="images/lpathlen1.png"/></p>
<p>The learnings can be summarized as:</p>
<ul>
<li>
<p><strong>Average path length increases</strong>. What we see here is that at first, the average path length increases. This is probably due to the fact that when we know nothing about the environment, we are likely to get trapped in bad states, water or wolf. As we learn more and start using this knowledge, we can explore the environment for longer, but we still do not know where the apples are very well.</p>
</li>
<li>
<p><strong>Path length decrease, as we learn more</strong>. Once we learn enough, it becomes easier for the agent to achieve the goal, and the path length starts to decrease. However, we are still open to exploration, so we often diverge away from the best path, and explore new options, making the path longer than optimal.</p>
</li>
<li>
<p><strong>Length increase abruptly</strong>. What we also observe on this graph is that at some point, the length increased abruptly. This indicates the stochastic nature of the process, and that we can at some point "spoil" the Q-Table coefficients by overwriting them with new values. This ideally should be minimized by decreasing learning rate (for example, towards the end of training, we only adjust Q-Table values by a small value).</p>
</li>
</ul>
<p>Overall, it is important to remember that the success and quality of the learning process significantly depends on parameters, such as learning rate, learning rate decay, and discount factor. Those are often called <strong>hyperparameters</strong>, to distinguish them from <strong>parameters</strong>, which we optimize during training (for example, Q-Table coefficients). The process of finding the best hyperparameter values is called <strong>hyperparameter optimization</strong>, and it deserves a separate topic.</p>
<h3 id="post-lecture-quiz"><a href="https://gray-sand-07a10f403.1.azurestaticapps.net/quiz/46/">Post-lecture quiz</a><a class="headerlink" href="#post-lecture-quiz" title="Permanent link">¶</a></h3>
<h3 id="assignment">Assignment<a class="headerlink" href="#assignment" title="Permanent link">¶</a></h3>
<p><a href="assignment.md">A More Realistic World</a></p></div>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="Last update">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime">February 19, 2025 15:07:13</span>
</span>
</aside>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  Back to top
</button>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Reinforcement" class="md-footer__link md-footer__link--prev" href="../">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Reinforcement
              </div>
</div>
</a>
<a aria-label="Next: Gym" class="md-footer__link md-footer__link--next" href="../2-Gym/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Gym
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/gitmichaelqiu" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.path", "navigation.top", "navigation.footer", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../../../../assets/javascripts/workers/search.07f07601.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../../../assets/javascripts/bundle.56dfad97.min.js"></script>
<script src="../../../../javascripts/mathjax.js"></script>
<script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
</body>
</html>